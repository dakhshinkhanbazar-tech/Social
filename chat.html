<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Private Chat</title>
    <style>
        body { background: #e5ddd5; font-family: sans-serif; margin: 0; padding: 10px; }
        .header { background: #075e54; color: white; padding: 12px; font-weight: bold; text-align: center; border-radius: 5px; }
        .msg-box { background: white; height: 350px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin: 10px 0; border-radius: 5px; }
        .msg-item { background: #fff; padding: 8px; margin: 5px 0; border-radius: 8px; border: 1px solid #ddd; font-size: 14px; }
        .time { font-size: 10px; color: #888; display: block; }
        .send-btn { background: #075e54; color: white; padding: 15px; text-decoration: none; display: block; text-align: center; font-weight: bold; border-radius: 8px; }
        .refresh-btn { background: #555; color: white; border: none; padding: 10px; width: 100%; border-radius: 5px; cursor: pointer; margin-bottom: 5px; }
    </style>
</head>
<body>
    <div class="header">Chat Room</div>

    <div class="msg-box" id="displayMsgs">Loading messages...</div>

    <button class="refresh-btn" onclick="loadMessages()">üîÑ Refresh Chat</button>

    <a href="https://docs.google.com/forms/d/e/1FAIpQLSfmE76RL2xnBFpbccLuCy5_qB4IA-F7vkSGQ4Rl1byGQwDfZw/viewform" target="_blank" class="send-btn">‚ûï WRITE MESSAGE</a>

    <script>
        // ‡¶§‡ßã‡¶Æ‡¶æ‡¶∞ ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶∂‡¶ø‡¶ü‡ßá‡¶∞ CSV ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï
        var sheetUrl = "https://docs.google.com/spreadsheets/d/1vCbeWnAt81SExCWhI8jYpS_jE4lYjKzL05jY9D3Yy-E/gviz/tq?tqx=out:csv";

        function loadMessages() {
            fetch(sheetUrl)
            .then(res => res.text())
            .then(data => {
                var rows = data.split("\n");
                var html = "";

                // i=1 ‡¶•‡ßá‡¶ï‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶ï‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶•‡¶Æ ‡¶∞‡ßã ‡¶π‡ßá‡¶°‡¶æ‡¶∞
                for (var i = 1; i < rows.length; i++) {
                    var cols = rows[i].split(",");
                    if (cols.length >= 2) {
                        var timestamp = cols[0].replace(/"/g, "").trim(); // Column A
                        var message = cols[1].replace(/"/g, "").trim();  // Column B

                        html += "<div class='msg-item'>";
                        html += "<span>" + message + "</span>";
                        html += "<span class='time'>" + timestamp + "</span>";
                        html += "</div>";
                    }
                }
                document.getElementById('displayMsgs').innerHTML = html || "No messages found.";
                
                // ‡¶Ö‡¶ü‡ßã ‡¶∏‡ßç‡¶ï‡ßç‡¶∞‡¶≤ ‡¶®‡¶ø‡¶ö‡ßá ‡¶Ø‡¶æ‡¶¨‡ßá
                var box = document.getElementById('displayMsgs');
                box.scrollTop = box.scrollHeight;
            })
            .catch(err => {
                document.getElementById('displayMsgs').innerHTML = "Error loading messages. Check internet or Sheet sharing.";
            });
        }

        // ‡¶∂‡ßÅ‡¶∞‡ßÅ‡¶§‡ßá ‡¶è‡¶ï‡¶¨‡¶æ‡¶∞ ‡¶≤‡ßã‡¶° ‡¶π‡¶¨‡ßá
        loadMessages();
    </script>
</body>
</html>
