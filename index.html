<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lite Social - Secure</title>
    <style>
        body { background: #000; color: #00ff00; font-family: monospace; margin: 0; padding: 10px; }
        .box { border: 1px solid #00ff00; padding: 10px; border-radius: 5px; }
        h3 { text-align: center; margin-top: 0; color: #fff; border-bottom: 1px solid #00ff00; }
        input { width: 90%; background: #111; color: #0f0; border: 1px solid #0f0; padding: 8px; margin: 5px 0; }
        button { background: #00ff00; color: #000; border: none; padding: 10px; width: 100%; font-weight: bold; cursor: pointer; }
        #chat-window { height: 200px; overflow-y: scroll; border: 1px dashed #00ff00; padding: 5px; margin: 10px 0; font-size: 13px; }
        .msg { margin-bottom: 5px; border-bottom: 1px solid #222; }
        .sender { color: #fff; font-weight: bold; }
        .footer { font-size: 10px; text-align: center; margin-top: 10px; color: #888; }
    </style>
</head>
<body>

<div class="box">
    <div id="login-ui" style="display:none;">
        <h3>üîí LOGIN</h3>
        <form action="https://script.google.com/macros/s/AKfycbzCA5DnBiCYI-slVMgd2Lv2PNYytk0PWSHNfEl8D003LNKVzLLPazCEMBQhayCUN-g8/exec" method="get">
            ‡¶®‡¶æ‡¶Æ ‡¶¶‡¶ø‡¶®:<br>
            <input type="text" name="user" required><br>
            ‡¶™‡¶ø‡¶® ‡¶ï‡ßã‡¶°:<br>
            <input type="number" name="pin" required><br>
            <button type="submit">‡¶™‡ßç‡¶∞‡¶¨‡ßá‡¶∂ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        </form>
        <div class="footer">‡¶è‡¶ï‡¶æ‡¶â‡¶®‡ßç‡¶ü ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡¶≤‡ßá ‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶´‡¶∞‡ßç‡¶Æ‡ßá ‡¶∞‡ßá‡¶ú‡¶ø‡¶∏‡ßç‡¶ü‡ßç‡¶∞‡ßá‡¶∂‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®‡•§</div>
    </div>

    <div id="chat-ui" style="display:none;">
        <h3>üí¨ CHAT ROOM</h3>
        <div>‡¶á‡¶â‡¶ú‡¶æ‡¶∞: <b id="user-display"></b></div>
        <div id="chat-window">‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</div>
        <input type="text" id="msg-input" placeholder="‡¶Æ‡ßá‡¶∏‡ßá‡¶ú ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®...">
        <button onclick="sendMsg()">‡¶™‡¶æ‡¶†‡¶æ‡¶®</button>
        <button onclick="window.location.href='index.html'" style="background:red; margin-top:5px; padding:3px; font-size:11px;">‡¶≤‡¶ó‡¶Ü‡¶â‡¶ü</button>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

<script>
    // ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶´‡¶æ‡¶Ø‡¶º‡¶æ‡¶∞‡¶¨‡ßá‡¶∏ ‡¶ï‡¶®‡¶´‡¶ø‡¶ó‡¶æ‡¶∞‡ßá‡¶∂‡¶®
    var firebaseConfig = {
        apiKey: "AIzaSyCvQ4ti0RjqmTCUZ5g5dXua_vjGNqqlyeg",
        databaseURL: "https://social-794e8-default-rtdb.firebaseio.com",
        projectId: "social-794e8"
    };
    firebase.initializeApp(firebaseConfig);
    var db = firebase.database();

    // URL ‡¶•‡ßá‡¶ï‡ßá ‡¶°‡¶æ‡¶ü‡¶æ ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ
    var params = new URLSearchParams(window.location.search);
    var name = params.get('user');
    var key = params.get('key'); // ‡¶è‡¶ü‡¶ø‡¶á ‡¶∏‡¶ø‡¶ï‡¶ø‡¶â‡¶∞‡¶ø‡¶ü‡¶ø ‡¶™‡¶ø‡¶®

    // ‡¶∏‡ßÅ‡¶∞‡¶ï‡ßç‡¶∑‡¶æ‡¶∞ ‡¶Æ‡ßÇ‡¶≤ ‡¶≤‡¶ú‡¶ø‡¶ï
    if (name && key) {
        // ‡¶Ø‡¶¶‡¶ø ‡¶®‡¶æ‡¶Æ ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶ø (key) ‡¶¶‡ßÅ‡¶á‡¶ü‡¶æ‡¶á ‡¶•‡¶æ‡¶ï‡ßá ‡¶§‡¶¨‡ßá‡¶á ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶ñ‡ßÅ‡¶≤‡¶¨‡ßá
        document.getElementById('chat-ui').style.display = 'block';
        document.getElementById('user-display').innerText = name;
        
        // ‡¶ö‡ßç‡¶Ø‡¶æ‡¶ü ‡¶≤‡ßã‡¶° ‡¶ï‡¶∞‡¶æ
        db.ref("public_chat").limitToLast(15).on("value", function(snap) {
            var win = document.getElementById('chat-window');
            win.innerHTML = "";
            snap.forEach(function(child) {
                var m = child.val();
                win.innerHTML += '<div class="msg"><span class="sender">' + m.sender + ':</span> ' + m.text + '</div>';
            });
            win.scrollTop = win.scrollHeight;
        });
    } else {
        // ‡¶Ø‡¶¶‡¶ø ‡¶™‡¶ø‡¶® ‡¶®‡¶æ ‡¶•‡¶æ‡¶ï‡ßá ‡¶§‡¶¨‡ßá ‡¶≤‡¶ó‡¶á‡¶® ‡¶™‡ßá‡¶ú ‡¶¶‡ßá‡¶ñ‡¶æ‡¶¨‡ßá
        document.getElementById('login-ui').style.display = 'block';
    }

    function sendMsg() {
        var input = document.getElementById('msg-input');
        var text = input.value;
        if(text) {
            db.ref("public_chat").push({
                sender: name,
                text: text,
                timestamp: Date.now()
            });
            input.value = "";
        }
    }
</script>

</body>
</html>
